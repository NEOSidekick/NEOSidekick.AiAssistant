(()=>{var q=Object.create;var x=Object.defineProperty;var G=Object.getOwnPropertyDescriptor;var Y=Object.getOwnPropertyNames;var z=Object.getPrototypeOf,X=Object.prototype.hasOwnProperty;var Q=(e,t)=>()=>(e&&(t=e(e=0)),t);var k=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports);var Z=(e,t,r,d)=>{if(t&&typeof t=="object"||typeof t=="function")for(let c of Y(t))!X.call(e,c)&&c!==r&&x(e,c,{get:()=>t[c],enumerable:!(d=G(t,c))||d.enumerable});return e};var S=(e,t,r)=>(r=e!=null?q(z(e)):{},Z(t||!e||!e.__esModule?x(r,"default",{value:e,enumerable:!0}):r,e));function o(e){return(...t)=>{if(window["@Neos:HostPluginAPI"]&&window["@Neos:HostPluginAPI"][`@${e}`])return window["@Neos:HostPluginAPI"][`@${e}`](...t);throw new Error("You are trying to read from a consumer api that hasn't been initialized yet!")}}var p=Q(()=>{});var W=k((Ce,I)=>{p();I.exports=o("NeosProjectPackages")().ReactUiComponents});var j=k((ve,F)=>{p();F.exports=o("NeosProjectPackages")().NeosUiReduxStore});var L=k((Ee,B)=>{p();B.exports=o("vendor")().React});var K=k((Ie,T)=>{p();T.exports=o("vendor")().reactRedux});var M=k((Fe,D)=>{p();D.exports=o("vendor")().reduxSagaEffects});p();var R=o("manifest");var N=S(W()),m=S(j()),n=S(L()),v=S(K()),U=S(M());function H(e){return new Promise(t=>setTimeout(t,e))}R("NEOSidekick.AiAssistant",{},(e,t)=>{let r=null,d=new XMLHttpRequest;if(d.open("GET","/neosidekick/aiassistant/configuration",!1),d.withCredentials=!0,d.addEventListener("load",f=>{let s=f.target;s?.status>=200&&s?.status<=299&&(r=JSON.parse(s.responseText))}),d.send(),r===null)return;let c=e.get("containers"),$=c.get("App"),J=f=>{let s=localStorage.getItem("NEOSidekick")?JSON.parse(localStorage.getItem("NEOSidekick")):{open:!0,fullscreen:!1},[u,b]=n.useState(s?.open),A=i=>{b(i),s.open=i,localStorage.setItem("NEOSidekick",JSON.stringify(s))},[l,g]=n.useState(s?.fullscreen),w=i=>{g(i),s.fullscreen=i,localStorage.setItem("NEOSidekick",JSON.stringify(s))},_=(i,C,P)=>{if(i)return n.createElement(N.IconButton,{icon:C?"compress":"expand",onClick:P})},h=(i,C,P)=>{if(!C)return n.createElement(N.IconButton,{icon:i?"chevron-circle-right":"chevron-circle-left",onClick:P})},y=(0,v.useSelector)(m.selectors.CR.ContentDimensions.active),O=(0,v.useSelector)(i=>i?.user?.preferences?.interfaceLanguage),a=new URL("https://api.neosidekick.com/chat/");return a.searchParams.append("contentLanguage",y.language?y.language[0]:""),a.searchParams.append("interfaceLanguage",O),a.searchParams.append("userId",r.userId),a.searchParams.append("plattform","neos"),a.searchParams.append("domain",r.domain),a.searchParams.append("siteName",r.siteName),r?.referral&&a.searchParams.append("referral",r?.referral),r?.apikey&&a.searchParams.append("apikey",r?.apikey),n.createElement("div",{className:`neosidekick_appWrapper ${u?"neosidekick_appWrapper--sidebar-open":""}  ${l?"neosidekick_appWrapper--sidebar-fullscreen":""}`},n.createElement($,{...f}),n.createElement("div",{className:"neosidekick_sideBar"},n.createElement("div",{className:"neosidekick_sideBar__title"},n.createElement(N.Headline,{className:`neosidekick_sideBar__title-headline ${u?"neosidekick_sideBar__title-headline--open":""}`},"AI Sidekick"),n.createElement("div",null,_(u,l,()=>w(!l)),h(u,l,()=>A(!u)))),n.createElement("iframe",{className:`neosidekick_sideBar__frame ${u?"neosidekick_sideBar__frame--open":""}`,src:a.toString(),allow:"clipboard-write"})))};c.set("App",J);let V=function*(){yield(0,U.takeLatest)([m.actionTypes.UI.ContentCanvas.SET_SRC,m.actionTypes.UI.ContentCanvas.RELOAD,m.actionTypes.CR.Nodes.MERGE],function*(){yield H(500);let f=e.get("@neos-project/neos-ui-contentrepository"),s=t.store.getState(),b=document.getElementsByName("neos-content-main")[0]?.contentDocument,A=document.getElementsByClassName("neosidekick_sideBar__frame")[0],l=s?.ui?.contentCanvas?.previewUrl,g=s?.cr?.nodes?.documentNode,w=Object.values(s?.cr?.nodes?.byContextPath||{}).filter(h=>{let y=f.getRole("document");if(!y)throw new Error("Document role is not loaded!");let O=f.getSubTypesOf(y);return g&&h.contextPath.indexOf(g.split("@")[0])===0&&(h.contextPath===g||!O.includes(h.nodeType))}),_={version:"1.0",eventName:"page-changed",data:{url:l,title:b?.title,content:b?.body?.innerHTML,structuredContent:w}};console.log(_),A.contentWindow.postMessage(_,"*")})};e.get("sagas").set("NEOSidekick.AiAssistant/debug",{saga:V})});})();
//# sourceMappingURL=Plugin.js.map
